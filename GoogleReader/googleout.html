<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=latin1">
  <style type="text/css">
td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }
body .hll { background-color: #ffffcc }
body  { background: #f8f8f8; }
body .c { color: #408080; font-style: italic } /* Comment */
body .err { border: 1px solid #FF0000 } /* Error */
body .k { color: #008000; font-weight: bold } /* Keyword */
body .o { color: #666666 } /* Operator */
body .cm { color: #408080; font-style: italic } /* Comment.Multiline */
body .cp { color: #BC7A00 } /* Comment.Preproc */
body .c1 { color: #408080; font-style: italic } /* Comment.Single */
body .cs { color: #408080; font-style: italic } /* Comment.Special */
body .gd { color: #A00000 } /* Generic.Deleted */
body .ge { font-style: italic } /* Generic.Emph */
body .gr { color: #FF0000 } /* Generic.Error */
body .gh { color: #000080; font-weight: bold } /* Generic.Heading */
body .gi { color: #00A000 } /* Generic.Inserted */
body .go { color: #888888 } /* Generic.Output */
body .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
body .gs { font-weight: bold } /* Generic.Strong */
body .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
body .gt { color: #0044DD } /* Generic.Traceback */
body .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
body .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
body .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
body .kp { color: #008000 } /* Keyword.Pseudo */
body .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
body .kt { color: #B00040 } /* Keyword.Type */
body .m { color: #666666 } /* Literal.Number */
body .s { color: #BA2121 } /* Literal.String */
body .na { color: #7D9029 } /* Name.Attribute */
body .nb { color: #008000 } /* Name.Builtin */
body .nc { color: #0000FF; font-weight: bold } /* Name.Class */
body .no { color: #880000 } /* Name.Constant */
body .nd { color: #AA22FF } /* Name.Decorator */
body .ni { color: #999999; font-weight: bold } /* Name.Entity */
body .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
body .nf { color: #0000FF } /* Name.Function */
body .nl { color: #A0A000 } /* Name.Label */
body .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
body .nt { color: #008000; font-weight: bold } /* Name.Tag */
body .nv { color: #19177C } /* Name.Variable */
body .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
body .w { color: #bbbbbb } /* Text.Whitespace */
body .mf { color: #666666 } /* Literal.Number.Float */
body .mh { color: #666666 } /* Literal.Number.Hex */
body .mi { color: #666666 } /* Literal.Number.Integer */
body .mo { color: #666666 } /* Literal.Number.Oct */
body .sb { color: #BA2121 } /* Literal.String.Backtick */
body .sc { color: #BA2121 } /* Literal.String.Char */
body .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
body .s2 { color: #BA2121 } /* Literal.String.Double */
body .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
body .sh { color: #BA2121 } /* Literal.String.Heredoc */
body .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
body .sx { color: #008000 } /* Literal.String.Other */
body .sr { color: #BB6688 } /* Literal.String.Regex */
body .s1 { color: #BA2121 } /* Literal.String.Single */
body .ss { color: #19177C } /* Literal.String.Symbol */
body .bp { color: #008000 } /* Name.Builtin.Pseudo */
body .vc { color: #19177C } /* Name.Variable.Class */
body .vg { color: #19177C } /* Name.Variable.Global */
body .vi { color: #19177C } /* Name.Variable.Instance */
body .il { color: #666666 } /* Literal.Number.Integer.Long */

  </style>
</head>
<body>
<h2></h2>

<div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="kn">from</span> <span class="nn">mako.template</span> <span class="kn">import</span> <span class="n">Template</span>


<span class="k">def</span> <span class="nf">render_header</span><span class="p">():</span>
    <span class="n">headerString</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span>
<span class="s">    &lt;html&gt;&lt;head&gt;&lt;title&gt;Google Reader Flatfile&lt;/title&gt;</span>
<span class="s">    &lt;link rel=&#39;stylesheet&#39; type=&#39;text/css&#39; href=&#39;bootstrap2.css&#39;&gt;</span>
<span class="s">    &lt;style&gt;</span>
<span class="s">    body {</span>
<span class="s">    margin: 0;</span>
<span class="s">    font-family: Georgia, serif;</span>
<span class="s">    font-size: 18px;</span>
<span class="s">    line-height: 2.0;</span>
<span class="s">    color: #222222;</span>
<span class="s">    background-color: #ffffff;}</span>
<span class="s">    .container { width: 940px; margin-left: auto; margin-right: auto;}</span>
<span class="s">    .alternatelook { background-color: #dddddd }</span>
<span class="s">    .item { padding: 10px; }</span>
<span class="s">    .row {</span>
<span class="s">    margin-top: 10px;</span>
<span class="s">    border-left: 1px solid black;</span>
<span class="s">    clear: both;</span>
<span class="s">    background-color: #eeeeee;</span>
<span class="s">    }</span>
<span class="s">    .comment {</span>
<span class="s">    font-family: consolas, sans-serif;</span>
<span class="s">    font-size: 16px;</span>
<span class="s">    background-color: #e0e0ff;</span>
<span class="s">    margin-left: -15px;</span>
<span class="s">    margin-right: -15px;</span>
<span class="s">    }</span>
<span class="s">    .annotation {</span>
<span class="s">    font-family: proxima, sans-serif;</span>
<span class="s">    font-size: 16px;</span>
<span class="s">    padding-top: 20px;</span>
<span class="s">    background-color: #c0c0dd;</span>
<span class="s">    display: block;</span>
<span class="s">    margin-left: -20px;</span>
<span class="s">    margin-right: -20px;</span>
<span class="s">    padding-left: 50px;</span>
<span class="s">    }</span>
<span class="s">    .selected {</span>
<span class="s">    background-color: #f0a0f0;</span>
<span class="s">    }</span>
<span class="s">    .PageTitle {</span>
<span class="s">    float: left;</span>
<span class="s">    margin-right: 200px;</span>
<span class="s">    }</span>
<span class="s">    .PageNav {</span>
<span class="s">    float: right;</span>
<span class="s">    width: 200px;</span>
<span class="s">    }</span>
<span class="s">    h2 {clear: all}</span>
<span class="s">    h3 {clear: all; line-height: 1.1;}</span>
<span class="s">    .itemorigin {</span>
<span class="s">    float: right;</span>
<span class="s">    width: 200px;</span>
<span class="s">    font-size: 12px;</span>
<span class="s">    line-height: 1.1;</span>
<span class="s">    align: right;</span>
<span class="s">    }</span>

<span class="s">    .itemtitle {</span>
<span class="s">    </span>
<span class="s">    margin-right: 240px</span>
<span class="s">    line-height: 1.1;</span>
<span class="s">    font: 175% bold;</span>
<span class="s">    font-family: proxima bold, sans-serif bold;</span>
<span class="s">    font-weight: bold;</span>
<span class="s">    }</span>
<span class="s">    .itemContent {</span>
<span class="s">    clear: all;</span>
<span class="s">    background-color: #ffffff;</span>
<span class="s">    padding: 10px;</span>

<span class="s">    }</span>
<span class="s">    .alternatelook .itemContent {</span>
<span class="s">    background-color: #eeeeee;</span>
<span class="s">    }</span>
<span class="s">    .parentNav a:visited { color: #eeeeee ; }</span>
<span class="s">    .parentNav a:link { color: #eeeeee ; }</span>
<span class="s">    &lt;/style&gt;</span>
<span class="s">    &lt;/head&gt;&lt;body&gt;</span>
<span class="s">&lt;div class = &#39;parentNav&#39; style=&#39;align: center; font: 125%; color: #eeeeee; background-color: #006;&#39; align=&#39;center&#39;&gt;</span>
<span class="s">&lt;a href=&#39;DougStarred001.html&#39;&gt;Starred&lt;/a&gt;</span>
<span class="s"> - &lt;a href=&#39;DougShared001.html&#39;&gt;Shared&lt;/a&gt;</span>
<span class="s"> - &lt;a href=&#39;DougFollowers001.html&#39;&gt;FollowerShares&lt;/a&gt;</span>
<span class="s">&lt;/div&gt;</span>
<span class="s">    &lt;div class=&#39;container&#39;&gt;</span>
<span class="s">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">headerString</span>


<span class="k">def</span> <span class="nf">render_footer</span><span class="p">():</span>
    <span class="n">footerString</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">footerString</span>

<span class="k">def</span> <span class="nf">render_item</span><span class="p">(</span><span class="n">readerItem</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ItemNumber</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">CommentString</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">Itemstring</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">AnnotString</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">TimeStamp</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">CommentNum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">UrlString</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">Via</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">Origin</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

    <span class="n">TimeStamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span>
        <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;updated&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%m/</span><span class="si">%d</span><span class="s">/%Y %I:%M %p&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s">&quot;via&quot;</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;via&quot;</span><span class="p">]:</span>
            <span class="n">Via</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s">&quot;title&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="s">&quot;origin&quot;</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;origin&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="s">&quot;title&quot;</span> <span class="ow">in</span> <span class="n">o</span><span class="p">:</span>
                <span class="n">Origin</span> <span class="o">=</span> <span class="s">&quot;&lt;a href=&#39;&quot;</span> <span class="o">+</span> <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;origin&quot;</span><span class="p">][</span><span class="s">&quot;htmlUrl&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;&#39;&gt;&quot;</span> 
                <span class="n">Origin</span> <span class="o">+=</span> <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;origin&quot;</span><span class="p">][</span><span class="s">&quot;title&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;&lt;/a&gt;&quot;</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Via</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span> 
                    <span class="n">Origin</span> <span class="o">+=</span> <span class="s">&quot; : &quot;</span> <span class="o">+</span> <span class="n">Via</span>  

    <span class="k">if</span> <span class="p">(</span><span class="n">ItemNumber</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ItemString</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&lt;div class=&#39;item&#39;&gt;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ItemString</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&lt;div class=&#39;item alternatelook&#39;&gt;&quot;</span>

    <span class="n">ItemString</span> <span class="o">+=</span> <span class="s">&quot;&lt;span class=&#39;itemorigin&#39; id = &#39;item&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ItemNumber</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&#39;&gt;&quot;</span>  
    <span class="n">ItemString</span> <span class="o">+=</span> <span class="n">Origin</span> <span class="o">+</span> <span class="s">&quot; &lt;br&gt;&lt;/br&gt; &quot;</span> <span class="o">+</span> <span class="n">TimeStamp</span> <span class="o">+</span> <span class="s">&quot;&lt;/span&gt;&quot;</span>

    <span class="k">if</span> <span class="s">&quot;canonical&quot;</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;canonical&quot;</span><span class="p">]:</span>
            <span class="n">UrlString</span> <span class="o">=</span> <span class="s">&quot;&lt;a href = &#39;&quot;</span> <span class="o">+</span> <span class="n">cn</span><span class="p">[</span><span class="s">&quot;href&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;&#39;&gt;&quot;</span>
    <span class="k">elif</span> <span class="s">&quot;alternate&quot;</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">al</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;alternate&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="s">&quot;href&quot;</span> <span class="ow">in</span> <span class="n">al</span><span class="p">:</span>
                <span class="n">UrlString</span> <span class="o">=</span> <span class="s">&quot;&lt;a href = &#39;&quot;</span> <span class="o">+</span> <span class="n">al</span><span class="p">[</span><span class="s">&quot;href&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;&#39;&gt;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">UrlString</span> <span class="o">=</span> <span class="s">&quot;&lt;a name=&#39;unlinked&#39;&gt;&quot;</span>

    <span class="k">if</span> <span class="s">&quot;title&quot;</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">:</span>
        <span class="n">ItemString</span> <span class="o">+=</span> <span class="s">&quot;&lt;span class=&#39;itemtitle&#39;&gt;&quot;</span> <span class="o">+</span> <span class="n">UrlString</span> <span class="o">+</span> <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;title&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;&lt;/a&gt;&lt;/span&gt;&quot;</span>

    <span class="k">if</span> <span class="s">&quot;content&quot;</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">:</span>
        <span class="n">ItemString</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&lt;div class=&#39;itemcontent&#39;&gt;&quot;</span> <span class="o">+</span> <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;content&quot;</span><span class="p">][</span><span class="s">&quot;content&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="s">&quot;content&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">:</span>
        <span class="k">if</span> <span class="s">&quot;summary&quot;</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">:</span>
            <span class="n">ItemString</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&lt;div class=&#39;itemcontent&#39;&gt;&quot;</span> <span class="o">+</span> <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;summary&quot;</span><span class="p">][</span><span class="s">&quot;content&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ItemString</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&lt;div class=&#39;itemcontent&#39; style=&#39;empty&#39;&gt;Empty ItemString&quot;</span>

    <span class="n">ItemString</span> <span class="o">+=</span> <span class="s">&quot;&lt;/div&gt;&quot;</span>

    <span class="k">if</span> <span class="s">&quot;comments&quot;</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;comments&quot;</span><span class="p">]:</span>
            <span class="n">CommentNum</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">CommentString</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&lt;div class=&#39;comment&#39;&gt; &quot;</span> <span class="o">+</span> <span class="s">&quot;&lt;b&gt; &quot;</span> 
            <span class="n">CommentString</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="s">&quot;author&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;:&lt;/b&gt; &quot;</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="s">&quot;htmlContent&quot;</span><span class="p">]</span> 
            <span class="n">CommentString</span> <span class="o">+=</span> <span class="s">&quot;&lt;/div&gt;&quot;</span>

    <span class="k">if</span> <span class="s">&quot;annotations&quot;</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">readerItem</span><span class="p">[</span><span class="s">&quot;annotations&quot;</span><span class="p">]:</span>
            <span class="n">AnnotString</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&lt;div class=&#39;annotation&#39;&gt;&quot;</span> 
            <span class="n">AnnotString</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="s">&quot;author&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> 
            <span class="n">AnnotString</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="s">&quot;content&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;&lt;/div&gt;&quot;</span>

    <span class="n">ItemString</span> <span class="o">=</span> <span class="n">ItemString</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">,</span> <span class="s">&#39;xmlcharrefreplace&#39;</span><span class="p">)</span>
    <span class="n">AnnotString</span> <span class="o">=</span> <span class="n">AnnotString</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">,</span> <span class="s">&#39;xmlcharrefreplace&#39;</span><span class="p">)</span>
    <span class="n">CommentString</span> <span class="o">=</span> <span class="n">CommentString</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">,</span> <span class="s">&#39;xmlcharrefreplace&#39;</span><span class="p">)</span>
    <span class="n">outputString</span> <span class="o">=</span> <span class="s">&quot;&lt;div class=&#39;row&#39;&gt;&quot;</span> <span class="o">+</span>  <span class="n">ItemString</span> <span class="o">+</span> <span class="n">AnnotString</span> 
    <span class="n">outputString</span> <span class="o">+=</span> <span class="n">CommentString</span> <span class="o">+</span> <span class="s">&quot;&lt;/div&gt;&lt;/div&gt;&quot;</span>

    <span class="k">return</span> <span class="n">outputString</span>


<span class="k">def</span> <span class="nf">build_file_items</span><span class="p">(</span><span class="n">itemCol</span><span class="p">,</span> <span class="n">outputfilename</span><span class="p">):</span>
    <span class="n">itemCount</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">pageCount</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">mostComments</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">mostAnnots</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">prevPageCount</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">currentItem</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">Pages</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">itemCol</span><span class="p">[</span><span class="s">&quot;items&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="n">pageLength</span>

    <span class="n">Output</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

    <span class="n">myList</span> <span class="o">=</span> <span class="n">itemCol</span><span class="p">[</span><span class="s">&quot;items&quot;</span><span class="p">]</span>
    <span class="n">sortedList</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">myList</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s">&#39;updated&#39;</span><span class="p">])</span>

    <span class="k">print</span> <span class="s">&#39;Pages: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Pages</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; pageLength : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageLength</span><span class="p">)</span> 

    <span class="n">Output</span> <span class="o">=</span> <span class="n">render_header</span><span class="p">()</span>
    <span class="n">Output</span> <span class="o">+=</span> <span class="n">RenderNavBar</span><span class="p">(</span><span class="n">pageCount</span><span class="p">,</span> <span class="n">Pages</span><span class="p">,</span> <span class="n">outputfilename</span><span class="p">)</span>
            
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sortedList</span><span class="p">:</span>
        <span class="n">currentItem</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">currentItem</span> <span class="o">%</span> <span class="n">pageLength</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="c"># print &#39;if (itemCount % pageLength) == 0:&#39;</span>
            <span class="k">if</span> <span class="n">pageCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c"># print &#39;ClosingPreviousPage&#39;</span>
                <span class="n">CloseCurrentPage</span><span class="p">(</span><span class="n">pageCount</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">outputfilename</span><span class="p">,</span> <span class="n">Pages</span><span class="p">)</span>
            <span class="n">pageCount</span> <span class="o">+=</span> <span class="mi">1</span>
            
        <span class="k">if</span> <span class="n">prevPageCount</span> <span class="o">!=</span> <span class="n">pageCount</span><span class="p">:</span>
            <span class="c"># print &#39;if prevPageCount != pageCount:&#39;</span>
            <span class="n">Output</span> <span class="o">=</span> <span class="n">render_header</span><span class="p">()</span>
            <span class="n">Output</span> <span class="o">+=</span> <span class="n">RenderNavBar</span><span class="p">(</span><span class="n">pageCount</span><span class="p">,</span> <span class="n">Pages</span><span class="p">,</span> <span class="n">outputfilename</span><span class="p">)</span>
            <span class="n">prevPageCount</span> <span class="o">=</span> <span class="n">pageCount</span>
        <span class="n">Output</span> <span class="o">+=</span> <span class="n">render_item</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">currentItem</span><span class="p">)</span>

    <span class="c"># close last page</span>
    <span class="n">CloseCurrentPage</span><span class="p">(</span><span class="n">prevPageCount</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">outputfilename</span><span class="p">,</span> <span class="n">Pages</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">CloseCurrentPage</span><span class="p">(</span><span class="n">pagenumber</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">outputfilename</span><span class="p">,</span> <span class="n">Pages</span><span class="p">):</span>

    <span class="n">Output</span> <span class="o">+=</span> <span class="n">RenderNavBar</span><span class="p">(</span><span class="n">pagenumber</span><span class="p">,</span> <span class="n">Pages</span><span class="p">,</span> <span class="n">outputfilename</span><span class="p">)</span>
    <span class="n">Output</span> <span class="o">+=</span> <span class="n">render_footer</span><span class="p">()</span>

    <span class="n">filename</span> <span class="o">=</span> <span class="n">outputfilename</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pagenumber</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.html&quot;</span>
    <span class="n">pageName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="n">filename</span>
    <span class="n">completeOutput</span> <span class="o">=</span> <span class="n">Output</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;w&#39;</span> <span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">completeOutput</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="s">&#39;wrote out file : &#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="n">filename</span>

<span class="k">def</span> <span class="nf">RenderNavBar</span><span class="p">(</span><span class="n">pageCount</span><span class="p">,</span> <span class="n">Pages</span><span class="p">,</span> <span class="n">outputfilename</span><span class="p">):</span>


    <span class="n">prevfilename</span> <span class="o">=</span> <span class="n">outputfilename</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.html&quot;</span>
    <span class="n">currentfilename</span> <span class="o">=</span> <span class="n">outputfilename</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.html&quot;</span>
    <span class="n">nextfilename</span> <span class="o">=</span> <span class="n">outputfilename</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.html&quot;</span>

    <span class="n">navString</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">navString</span> <span class="o">+=</span> <span class="s">&quot;&lt;h2&gt;&lt;div align=&#39;left&#39; class=PageTitle&gt;Page &quot;</span> 
    <span class="n">navString</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; of &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Pages</span><span class="p">)</span>
    <span class="n">navString</span> <span class="o">+=</span> <span class="s">&quot;&lt;/div&gt;&lt;div align=&#39;right&#39; class=PageNav&gt;&quot;</span>
    <span class="k">if</span> <span class="n">pageCount</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">navString</span> <span class="o">+=</span> <span class="s">&quot;&lt;a href=&#39;&quot;</span> <span class="o">+</span> <span class="n">prevfilename</span>
        <span class="n">navString</span> <span class="o">+=</span> <span class="s">&quot;&#39;&gt; &lt;&lt;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; &lt;/a&gt;&quot;</span>
    <span class="k">if</span> <span class="n">pageCount</span> <span class="o">&lt;</span> <span class="n">Pages</span><span class="p">:</span>
        <span class="n">navString</span> <span class="o">+=</span> <span class="s">&quot; - &quot;</span>
    <span class="k">if</span> <span class="n">pageCount</span> <span class="o">&lt;</span> <span class="n">Pages</span><span class="p">:</span>
        <span class="n">navString</span> <span class="o">+=</span> <span class="s">&quot;&lt;a href=&#39;&quot;</span> <span class="o">+</span> <span class="n">nextfilename</span> 
        <span class="n">navString</span> <span class="o">+=</span> <span class="s">&quot;&#39;&gt; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pageCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;&gt;&gt; &lt;/a&gt;&lt;/div&gt;&quot;</span>
    <span class="n">navString</span> <span class="o">+=</span> <span class="s">&quot;&lt;/h2&gt;&quot;</span>

    <span class="k">return</span> <span class="n">navString</span>


<span class="n">TotalSharedByComments</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">TotalSharedByAnnot</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">TotalSharedComments</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">TotalSharedAnnot</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">display</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">itemContent</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
<span class="n">previousContent</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
<span class="n">itemDefs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">commentDefs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">annotationDefs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sharedbyDefs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">itemCount</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pageCount</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">mostComments</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">mostAnnots</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pageLength</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">pp</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">txt</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;/Users/doug.churchman/Documents/src/data/shared-by-followers.json&#39;</span><span class="p">)</span>
<span class="n">sharedby</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">txt</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;utf-8&quot;</span><span class="p">))</span>
<span class="n">build_file_items</span><span class="p">(</span><span class="n">sharedby</span><span class="p">,</span> <span class="s">&quot;DougFollowers&quot;</span><span class="p">)</span>

<span class="n">txt</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;/Users/doug.churchman/Documents/src/data/shared.json&#39;</span><span class="p">)</span>
<span class="n">shared</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">txt</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;utf-8&quot;</span><span class="p">))</span>
<span class="n">build_file_items</span><span class="p">(</span><span class="n">shared</span><span class="p">,</span> <span class="s">&quot;DougShared&quot;</span><span class="p">)</span>

<span class="n">txt</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;/Users/doug.churchman/Documents/src/data/starred.json&#39;</span><span class="p">)</span>
<span class="n">shared</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">txt</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;utf-8&quot;</span><span class="p">))</span>
<span class="n">build_file_items</span><span class="p">(</span><span class="n">shared</span><span class="p">,</span> <span class="s">&quot;DougStarred&quot;</span><span class="p">)</span>


<span class="c"># txt = open(&#39;/Users/doug.churchman/Documents/src/data/allisonrae/starred.json&#39;)</span>
<span class="c"># starred = json.loads(txt.read().decode(&quot;utf-8&quot;))</span>
<span class="c"># build_file_items(starred, &quot;AlliStarred&quot;)</span>

<span class="c"># txt = open(&#39;/Users/doug.churchman/Documents/src/data/allisonrae/liked.json&#39;)</span>
<span class="c"># liked = json.loads(txt.read().decode(&quot;utf-8&quot;))</span>
<span class="c"># build_file_items(liked, &quot;AlliLiked&quot;)</span>

<span class="c"># txt = open(&#39;/Users/doug.churchman/Documents/src/data/allisonrae/shared.json&#39;)</span>
<span class="c"># shared = json.loads(txt.read().decode(&quot;utf-8&quot;))</span>
<span class="c"># build_file_items(shared, &quot;AlliShared&quot;)</span>

<span class="c"># txt = open(&#39;/Users/doug.churchman/Documents/src/data/allisonrae/shared-by-followers.json&#39;)</span>
<span class="c"># sharedby = json.loads(txt.read().decode(&quot;utf-8&quot;))</span>
<span class="c"># build_file_items(sharedby, &quot;AlliSharedBy&quot;)</span>
</pre></div>
</body>
</html>
